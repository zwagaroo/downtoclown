<html>
  <head>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <script type="text/javascript" src="https://www.airconsole.com/api/airconsole-1.8.0.js"></script>
    <style type="text/css">
      /* the style sheet dictates what our elements (buttons, backgrounds etc.) will look like. */

      #role-change {
          border: 5px solid;
          position: absolute;
          top: 50%;
          transform: translate(0, -50%);
          padding: 10px;
      }

      #interact-button{
          background-image: url("button.png");
          position: absolute;
          top: 20%;
          left: 10%;
          width: 80%;
          height: 60%;
          background-size: contain;
          background-repeat: no-repeat;
      }

      @font-face {
          font-family: "bubble-rainbow";
          src: url("bubble-rainbow.ttf");
      }


    </style>

    <script type="text/javascript" src="./airconsole-view-manager.js"></script>

    <script type="text/javascript">
      var airconsole;
      let viewmanager = null;
      let role = null;
      let roleName = "";
      let roleRule = "";
      let roleDescription = "";
      let descriptionImage = "";

      let prompts = null;

      function App() {
          /* JavaScript / Functionality. Add functions and evens here */
          this.airconsole = new AirConsole({"orientation" : "portrait"});
          viewmanager = new AirConsoleViewManager(this.airconsole);

          this.airconsole.onMessage = function(device_id, data) {
              console.log(data);
              const msg_type = data["msg_type"];
              switch (msg_type) {
              case "role_assignment":
                  console.log("ROLE CHANGE");

                  role = data["role"];
                  roleName = role.name;
                  roleRule = role.rule;
                  roleDescription = role.description;
                  roleDescriptionImage = role.descriptionImage;

                  viewmanager.controllersShow('role-change');
                  document.getElementById("myRole").innerHTML = roleName;
                  document.getElementById("myRoleDescription").innerHTML = roleDescription;

                  break;
              case "prompt_picking":
                  prompts = data["prompts"];
                  console.log(prompts);
                  document.getElementById("prompt-1").innerHTML = "hi hi hi hi hi ";
                  document.getElementById("prompt-2").innerHTML = "bye alskdjaslkdjasd n";
                  document.getElementById("prompt-3").innerHTML = "screeN alskdjasldk";
                  document.getElementById("prompt-4").innerHTML = "LOLOOL alskdjaslkdjasd";
                  document.getElementById("prompt-5").innerHTML = "GODODO alskjdalskdjalskdj";
              }

          };

          /*
           * Here we are adding support for mouse events manually.
           * --> WE STRONGLY ENCOURAGE YOU TO USE THE AIRCONSOLE CONTROLS LIBRARY
           * WHICH IS EVEN BETTER (BUT WE DONT WANT TO BLOAT THE CODE HERE).
           * https://github.com/AirConsole/airconsole-controls/
           *
           * DO NOT USE ONCLICK HANDLERS.
           * THEY ADD A 200MS DELAY!
           */
          if (!("ontouchstart" in document.createElement("div"))) {
              var elements = document.getElementsByTagName("*");
              for (var i = 0; i < elements.length; ++i) {
                  var element = elements[i];
                  var ontouchstart = element.getAttribute("ontouchstart");
                  if (ontouchstart) {
                      element.setAttribute("onmousedown", ontouchstart);
                  }
                  var ontouchend = element.getAttribute("ontouchend");
                  if (ontouchend) {
                      element.setAttribute("onmouseup", ontouchend);
                  }
              }
          }
      }

      App.prototype.sendMessageToScreen = function(msg) {
          var message = {
              "msg_type": "switch_state",
          }
          console.log(msg);
          this.airconsole.message(AirConsole.SCREEN, message);
      };

      App.prototype.sendPickedPrompt = function(prompt) {
          var message = {
              'msg_type': 'prompt_picked',
              'prompt': prompt,
          };
          console.log(message);
          this.airconsole.message(AirConsole.SCREEN, message);
      };

      App.prototype.sendPromptAnswer = function(answer) {
          var message = {
              'msg_type': 'prompt_answer',
              'answer': answer,
          };
          console.log(message);
          this.airconsole.message(AirConsole.SCREEN, message);
      };

      function submitAnswer() {
          let x = document.getElementById("myText").value;
          console.log(x);
          window.app.sendMessageToScreen(x);
      }
      function submitPrompt(buttonNumber) {
          let x = document.getElementById(buttonNumber).textContent;
          console.log(x.trim());
          // window.app.sendMessageToScreen(x);
      }
    </script>
  </head>

  <body onload="window.app = new App()" style="font-family: bubble-rainbow">
    <div id="lobby-waiting" class="view default-view">
      LOBBY HERE.
    </div>

    <div id="prompt-picking" class="view">
      <ul>
        <li>
          <button id="prompt-1" type="button" ontouchstart="submitPrompt('prompt-1')">
          </button>
        </li>
        <li>
          <button id="prompt-2" type="button" ontouchstart="submitPrompt('prompt-2')">
          </button>
        </li>

        <li>
          <button id="prompt-3" type="button" ontouchstart="submitPrompt('prompt-3')">
          </button>
        </li>

        <li>
          <button id="prompt-4" type="button" ontouchstart="submitPrompt('prompt-4')">
          </button>
        </li>

        <li>
          <button id="prompt-5" type="button" ontouchstart="submitPrompt('prompt-5')">
          </button>
        </li>
      </ul>
    </div>

    <div id="prompt-answer" class="view">
      <input type="text" id="myText">
      <button type="button" ontouchstart="submitAnswer()">
        Submit
      </button>
    </div>

    <div id="interact-button" class="view" ontouchstart="window.app.sendMessageToScreen('interact')"></div>

    <div id="role-change" class="view">
      <h1>Your role is: <span id="myRole"></span></h1>
      <h2><span id="myRoleDescription"></span></h2>

      <img src="jester-image.png" width="300" height="300" alt="">
    </div>

    <div id="voting-screen" class="view">
      <link rel="stylesheet" href="Scripts/Client/card-swiper/voting_view_style.css">
      <ion-icon id="dislike" name="heart-dislike"></ion-icon>
      <div id="swiper">
        <!-- <div class="card" style="--i:0">
             <img src="https://source.unsplash.com/random/1000x1000/?sky" alt="">
        </div>
        <div class="card" style="--i:1">
          <img src="https://source.unsplash.com/random/1000x1000/?landscape" alt="">
        </div>
        <div class="card" style="--i:2">
          <img src="https://source.unsplash.com/random/1000x1000/?ocean" alt="">
        </div>
        <div class="card" style="--i:3">
          <img src="https://source.unsplash.com/random/1000x1000/?moutain" alt="">
        </div>
        <div class="card" style="--i:4">
          <img src="https://source.unsplash.com/random/1000x1000/?forest" alt="">
        </div> -->
      </div>
      <ion-icon id="like" name="heart"></ion-icon>

      <script src="Scripts/Client/card-swiper/card.js"></script>
      <script src="Scripts/Client/card-swiper/voting_view_script.js"></script>
      <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
      <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    </div>

  </body>
</html>
